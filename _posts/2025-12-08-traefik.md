---
title: Traefik reverse proxy
date: 2025-12-08 17:00:00 +0100
categories: [docker, reverseproxy]
tags: [reverseproxy, middelware, letsencrypt, docker]     # TAG names should always be lowercase
author: mith  
description: How to setup traefik as a reverseproxy with letsencrypt.
toc: true
---

## Context
I have previously worked with nginx proxy manager and i liked it. However i wanted SSO auth as middleware and that was to complicated with nginx proxy manager. Hence i shiftet to Traefik. Which might be a steep learning curve, however when you get the grip on it. It is quite easy. 

The first thing to have in mind is labeling and the difference between static and dynamic files. 
The way i do it, is that i have Traefik running on a network, where if i put the container on that network i intent to expose it to Traefik. 

Also i have it working with letsencrypt and cloudflare as dns provider. 

## Setup 
First make sure to have docker installed. 
guide for installing docker and docker compose: [Install guide](https://docs.docker.com/engine/install/)

I like to have a directory specific for docker like /etc/docker/<container_name>

1. create a working dir for Traefik. 

2. create a compose file for Traefik:
```
touch docker-compose.yml
```

3. edit the file (i use nano in termial or vscode)

Compose Stack: 
```
networks:
  traefik-proxy:
    name: traefik-proxy

services:
  traefik:
    image: traefik:v3.6.5
    container_name: traefik
    restart: unless-stopped
    command:
     - --providers.file.filename=/traefik.yml
     - --log.level=debug
     - --certificatesresolvers.le.acme.tlschallenge=true

    environment:
      - TZ=Europe/Copenhagen # Change this to your timezone
      - CF_DNS_API_TOKEN=<cloudflare token>
    ports:
      - 80:80
      - 443:443
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - ./acme.json:/acme.json
      - ./traefik.yml:/traefik.yml
      - ./dynamic:/dynamic
      - ./certs:/certs:ro

    networks:
      - traefik-proxy
    labels:
      - traefik.enable=true

      # Route dashboard ONLY through traefik.home.labify.dk
      - traefik.http.routers.traefik.rule=Host(`traefik.prod.labify.dk`)
      - traefik.http.routers.traefik.entrypoints=websecure
      - traefik.http.routers.traefik.tls.certResolver=le

      # Enable Traefik internal API as a service
      - traefik.http.routers.traefik.service=api@internal

      # Enable auth for dashbord
      # - traefik.http.routers.traefik.middlewares=oauth2-proxy

  hello-world:
    image: kerwood/hello-world:latest
    container_name: hello-world
    restart: unless-stopped
    expose:
      - 3000
    networks:
      - traefik-proxy
    labels:
      - traefik.enable=true
      - traefik.http.services.hello.loadbalancer.server.port=3000
      - traefik.http.routers.hello.rule=Host(`hello.prod.labify.dk`)
      - traefik.http.routers.hello.tls.certResolver=le
      - traefik.http.routers.hello.entrypoints=websecure
      - traefik.http.routers.hello.middlewares=oauth2-proxy
```

## Test